<!DOCTYPE html>
<html lang="en" >

<head>
    <meta charset="UTF-8"><meta http-equiv="Content-Security-Policy"
content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com;connect-src 'self';script-src 'self' 'self'">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="base" content="https://synex.space/">

    
    <title>
~/S9n3x • Kubernetes-安装-Kubeadm-Containerd-1.24.0</title>

    
    
    

    
    

    
    
    
        
            <link rel="stylesheet" href="https://synex.space/custom_subset.css?h=0b9535a28bc3d5bf2321">
        
    

    
        <link rel="stylesheet" href="https://synex.space/main.css?h=3716ab3457d2dd050b3c" />
        <link rel="stylesheet" href="https://synex.space/skins/mint.css?h=504215cf6bc10586b487" />

    <meta name="color-scheme" content="light dark" />
        <meta name="description" content="" />
        <meta property="og:description" content="" />

    

    <meta property="og:title" content="Kubernetes-安装-Kubeadm-Containerd-1.24.0" />
    <meta property="og:type" content="article" />

    
<meta property="og:locale" content="en_GB" />

    <meta property="og:url" content="https:&#x2F;&#x2F;synex.space&#x2F;blog&#x2F;kubernetes-an-zhuang-kubeadm-containerd-1-24-0&#x2F;" /><meta property="og:site_name" content="~&#x2F;S9n3x">
        <noscript><link rel="stylesheet" href="https://synex.space/no_js.css"/></noscript>
        <script type="text/javascript" src="https://synex.space/js/initializeTheme.min.js"></script>
        <script defer src="https://synex.space/js/themeSwitcher.min.js"></script>
        <script defer src="https://synex.space/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e"></script>

        
    
</head>


<body>
    <a href="#main-content" id="skip-link">Skip to content</a>
    <header>
    <nav class="navbar">
        <div class="nav-title">
            <a class="home-title" href="https://synex.space/">~&#x2F;S9n3x</a>
        </div>
            <div class="nav-navs">
                <ul>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="https://synex.space/blog/">blog
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="https://synex.space/archive/">archive
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="https://synex.space/tags/">tags
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="https://synex.space/friends/">friends
                                </a>
                            </li>
                        <li class="menu-icons-container">
                        <ul class="menu-icons-group">
                            <li class="js menu-icon">
                                <div role="button" tabindex="0" id="search-button" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" aria-label="Click or press $SHORTCUT to open search">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                                        <path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/>
                                    </svg>
                                </div>
                            </li>

                            
                            

                            <li class="theme-switcher-wrapper js"><div
        title="Toggle dark&#x2F;light mode"
        class="theme-switcher"
        tabindex="0"
        role="button"
        aria-label="Toggle dark mode"
        aria-pressed="false">
    </div><div
        title="Reset mode to default"
        class="theme-resetter arrow"
        tabindex="0"
        role="button"
        aria-hidden="true"
        aria-label="Reset mode to default">
    </div>

</li>
</ul>
                    </li>
                </ul>
            </div>
        
    </nav>
</header>

    <div class="content" id="main-content">

        
        





<main>
    <article class="h-entry">
        <h1 class="p-name article-title">
            Kubernetes-安装-Kubeadm-Containerd-1.24.0
        </h1>
        <a class="u-url u-uid" href="https://synex.space/blog/kubernetes-an-zhuang-kubeadm-containerd-1-24-0/"></a>

        <ul class="meta"><span class="hidden p-author h-card">
<a rel="author" href="https:&#x2F;&#x2F;synex.space&#x2F;" class="u-url " title=""></a>
</span>
<li><time class="dt-published" datetime="2022-07-31T08:32:00">31st Jul 2022</time></li><li title="819 words"><span class='separator' aria-hidden='true'>•</span>5 min read</li><li class="tag"><span class='separator' aria-hidden='true'>•</span>Tags:&nbsp;</li><li class="tag"><a class="p-category" href="https://synex.space/tags/kai-yuan-gong-ju/">开源工具</a>,&nbsp;</li><li class="tag"><a class="p-category" href="https://synex.space/tags/kubernetes/">Kubernetes</a>,&nbsp;</li><li class="tag"><a class="p-category" href="https://synex.space/tags/kubeadm/">Kubeadm</a>,&nbsp;</li><li class="tag"><a class="p-category" href="https://synex.space/tags/containerd/">Containerd</a></li>
        </ul><section class="e-content body"><h1 id="zhun-bei-kai-shi">准备开始</h1>
<ul>
<li>一台兼容的 Linux 主机。Kubernetes 项目为基于 Debian 和 Red Hat 的 Linux 发行版以及一些不提供包管理器的发行版提供通用的指令</li>
<li>每台机器 2 GB 或更多的 RAM （如果少于这个数字将会影响你应用的运行内存）</li>
<li>2 CPU 核或更多</li>
<li>集群中的所有机器的网络彼此均能相互连接(公网和内网都可以)</li>
<li>节点之中不可以有重复的主机名、MAC 地址或 product_uuid。请参见这里了解更多详细信息。</li>
<li>开启机器上的某些端口。请参见<a href="https://kubernetes.io/zh-cn/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#check-required-ports">这里</a> 了解更多详细信息。</li>
<li>禁用交换分区。为了保证 kubelet 正常工作，你 必须 禁用交换分区。</li>
</ul>
<h1 id="huan-jing">环境</h1>
<table><thead><tr><th>主机名</th><th>系统</th><th>硬件</th><th>环境</th></tr></thead><tbody>
<tr><td>master.host.com</td><td>rocky8.5</td><td>2核CPU，2G内存</td><td>关闭selinux和防火墙，可使用主机名通信</td></tr>
<tr><td>work1.host.com</td><td>rocky8.5</td><td>2核CPU，2G内存</td><td>关闭selinux和防火墙，可使用主机名通信</td></tr>
<tr><td>work2.host.com</td><td>rocky8.5</td><td>2核CPU，2G内存</td><td>关闭selinux和防火墙，可使用主机名通信</td></tr>
</tbody></table>
<h1 id="chu-shi-hua-zhu-ji">初始化主机</h1>
<blockquote>
<p>一下操作所有主机都做</p>
</blockquote>
<h2 id="an-zhuang-pei-zhi-containerd">安装配置Containerd</h2>
<pre class="z-code"><code><span class="z-text z-plain">curl -o /etc/yum.repos.d/docker.repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
</span><span class="z-text z-plain">yum -y install containerd.io
</span><span class="z-text z-plain">containerd config default | sudo tee /etc/containerd/config.toml
</span><span class="z-text z-plain">sed -i &#39;s/SystemdCgroup = false/SystemdCgroup = true/g&#39; /etc/containerd/config.toml
</span><span class="z-text z-plain">systemctl enable --now containerd
</span></code></pre>
<h2 id="guan-bi-swapfen-qu">关闭SWAP分区</h2>
<pre class="z-code"><code><span class="z-text z-plain">sudo swapoff -a
</span><span class="z-text z-plain">sudo sed -ri &#39;s/.*swap.*/#&amp;/&#39; /etc/fstab
</span></code></pre>
<h2 id="yun-xu-iptables-jian-cha-qiao-jie-liu-liang-bing-pei-zhi-nei-he-zhuan-fa">允许 iptables 检查桥接流量并配置内核转发</h2>
<pre class="z-code"><code><span class="z-text z-plain">modprobe  br_netfilter
</span><span class="z-text z-plain">cat &lt;&lt;EOF | sudo tee /etc/modules-load.d/k8s.conf
</span><span class="z-text z-plain">br_netfilter
</span><span class="z-text z-plain">EOF
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">cat &lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf
</span><span class="z-text z-plain">net.bridge.bridge-nf-call-ip6tables = 1
</span><span class="z-text z-plain">net.bridge.bridge-nf-call-iptables = 1
</span><span class="z-text z-plain">net.ipv4.ip_forward = 1
</span><span class="z-text z-plain">EOF
</span><span class="z-text z-plain">sudo sysctl --system
</span></code></pre>
<h2 id="pei-zhi-ipvs">配置IPVS</h2>
<blockquote>
<p>service有基于iptables和基于ipvs两种代理模型。基于ipvs的性能要高一些。需要手动载入才能使用ipvs模块</p>
</blockquote>
<pre class="z-code"><code><span class="z-text z-plain">yum install -y ipset ipvsadm
</span><span class="z-text z-plain">cat &gt; /etc/sysconfig/modules/ipvs.modules &lt;&lt;EOF
</span><span class="z-text z-plain">#!/bin/bash
</span><span class="z-text z-plain">modprobe -- ip_vs
</span><span class="z-text z-plain">modprobe -- ip_vs_rr
</span><span class="z-text z-plain">modprobe -- ip_vs_wrr
</span><span class="z-text z-plain">modprobe -- ip_vs_sh
</span><span class="z-text z-plain">modprobe -- nf_conntrack_ipv4
</span><span class="z-text z-plain">EOF
</span><span class="z-text z-plain">chmod +x /etc/sysconfig/modules/ipvs.modules
</span><span class="z-text z-plain">/bin/bash /etc/sysconfig/modules/ipvs.modules
</span></code></pre>
<blockquote>
<p>如果出现以下<strong>报错</strong>则执行下面内容
<code>modprobe: FATAL: Module nf_conntrack_ipv4 not found in directory /lib/modules/4.18.0-348.el8.0.2.x86_64</code></p>
</blockquote>
<pre class="z-code"><code><span class="z-text z-plain">sed -i &#39;s/nf_conntrack_ipv4/nf_conntrack/g&#39; /etc/sysconfig/modules/ipvs.modules
</span><span class="z-text z-plain">/bin/bash /etc/sysconfig/modules/ipvs.modules
</span></code></pre>
<h2 id="an-zhuang-kubernetesxiang-guan-ruan-jian-gong-ju">安装Kubernetes相关软件工具</h2>
<pre class="z-code"><code><span class="z-text z-plain">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo
</span><span class="z-text z-plain">[kubernetes]
</span><span class="z-text z-plain">name=Kubernetes
</span><span class="z-text z-plain">baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/
</span><span class="z-text z-plain">enabled=1
</span><span class="z-text z-plain">gpgcheck=1
</span><span class="z-text z-plain">repo_gpgcheck=1
</span><span class="z-text z-plain">gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg
</span><span class="z-text z-plain">EOF
</span><span class="z-text z-plain">yum install -y kubelet-1.24.0 kubeadm-1.24.0 kubectl-1.24.0
</span><span class="z-text z-plain">systemctl enable --now kubelet
</span></code></pre>
<h1 id="an-zhuang-kubernetes">安装Kubernetes</h1>
<h2 id="masterjie-dian">MASTER节点</h2>
<p><strong>生成kubeadm配置文件:</strong><code>sudo kubeadm config print init-defaults &gt; kubeadm.yaml</code>
编辑kubeadm.yaml并修改下面内容</p>
<pre class="z-code"><code><span class="z-text z-plain">advertiseAddress: 改成自己的ip
</span><span class="z-text z-plain">nodeRegistration下的name字段:改成自己的主机名
</span><span class="z-text z-plain">imageRepository: registry.aliyuncs.com/google_containers
</span></code></pre>
<p><strong>在networking段添加pod的网段:</strong><code>podSubnet: 10.244.0.0/16</code>
修改后内容如下:</p>
<pre class="z-code"><code><span class="z-text z-plain">$ cat kubeadm.yaml
</span><span class="z-text z-plain">apiVersion: kubeadm.k8s.io/v1beta3
</span><span class="z-text z-plain">bootstrapTokens:
</span><span class="z-text z-plain">- groups:
</span><span class="z-text z-plain">  - system:bootstrappers:kubeadm:default-node-token
</span><span class="z-text z-plain">  token: abcdef.0123456789abcdef
</span><span class="z-text z-plain">  ttl: 24h0m0s
</span><span class="z-text z-plain">  usages:
</span><span class="z-text z-plain">  - signing
</span><span class="z-text z-plain">  - authentication
</span><span class="z-text z-plain">kind: InitConfiguration
</span><span class="z-text z-plain">localAPIEndpoint:
</span><span class="z-text z-plain">  advertiseAddress: 192.168.0.109
</span><span class="z-text z-plain">  bindPort: 6443
</span><span class="z-text z-plain">nodeRegistration:
</span><span class="z-text z-plain">  criSocket: unix:///var/run/containerd/containerd.sock
</span><span class="z-text z-plain">  imagePullPolicy: IfNotPresent
</span><span class="z-text z-plain">  name: master.host.com
</span><span class="z-text z-plain">  taints: null
</span><span class="z-text z-plain">---
</span><span class="z-text z-plain">apiServer:
</span><span class="z-text z-plain">  timeoutForControlPlane: 4m0s
</span><span class="z-text z-plain">apiVersion: kubeadm.k8s.io/v1beta3
</span><span class="z-text z-plain">certificatesDir: /etc/kubernetes/pki
</span><span class="z-text z-plain">clusterName: kubernetes
</span><span class="z-text z-plain">controllerManager: {}
</span><span class="z-text z-plain">dns: {}
</span><span class="z-text z-plain">etcd:
</span><span class="z-text z-plain">  local:
</span><span class="z-text z-plain">    dataDir: /var/lib/etcd
</span><span class="z-text z-plain">imageRepository: registry.aliyuncs.com/google_containers
</span><span class="z-text z-plain">kind: ClusterConfiguration
</span><span class="z-text z-plain">kubernetesVersion: 1.24.0
</span><span class="z-text z-plain">networking:
</span><span class="z-text z-plain">  dnsDomain: cluster.local
</span><span class="z-text z-plain">  serviceSubnet: 10.96.0.0/12
</span><span class="z-text z-plain">  podSubnet: 10.244.0.0/16
</span><span class="z-text z-plain">scheduler: {}
</span></code></pre>
<p><strong>下载Kubernetes所需镜像:</strong></p>
<pre class="z-code"><code><span class="z-text z-plain">$ kubeadm config --config kubeadm.yaml images pull
</span><span class="z-text z-plain">[config/images] Pulled registry.aliyuncs.com/google_containers/kube-apiserver:v1.24.0
</span><span class="z-text z-plain">[config/images] Pulled registry.aliyuncs.com/google_containers/kube-controller-manager:v1.24.0
</span><span class="z-text z-plain">[config/images] Pulled registry.aliyuncs.com/google_containers/kube-scheduler:v1.24.0
</span><span class="z-text z-plain">[config/images] Pulled registry.aliyuncs.com/google_containers/kube-proxy:v1.24.0
</span><span class="z-text z-plain">[config/images] Pulled registry.aliyuncs.com/google_containers/pause:3.7
</span><span class="z-text z-plain">[config/images] Pulled registry.aliyuncs.com/google_containers/etcd:3.5.3-0
</span><span class="z-text z-plain">[config/images] Pulled registry.aliyuncs.com/google_containers/coredns:v1.8.6
</span></code></pre>
<p>在意一下pause镜像的的版本名称我这里是<code>registry.aliyuncs.com/google_containers/pause:3.7</code>
修改containerd的配置文件/etc/containerd/config.toml,把里面的sandbox_image的值改为pause镜像的全称加版本</p>
<pre class="z-code"><code><span class="z-text z-plain">$ cat /etc/containerd/config.toml |grep sandbox
</span><span class="z-text z-plain">sandbox_image = &quot;registry.aliyuncs.com/google_containers/pause:3.7&quot;
</span></code></pre>
<p><strong>重启Containerd:</strong><code>systemctl restart containerd</code>
<strong>初始化master节点:</strong><code>kubeadm init --config kubeadm.yaml</code>
**注意:**修改containerd的sandbox_image配置是全部的主机都要修改
初始化成功之后会打印下面的内容</p>
<pre class="z-code"><code><span class="z-text z-plain">
</span><span class="z-text z-plain">Your Kubernetes control-plane has initialized successfully!
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">To start using your cluster, you need to run the following as a regular user:
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">  mkdir -p $HOME/.kube
</span><span class="z-text z-plain">  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
</span><span class="z-text z-plain">  sudo chown $(id -u):$(id -g) $HOME/.kube/config
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Alternatively, if you are the root user, you can run:
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">  export KUBECONFIG=/etc/kubernetes/admin.conf
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">You should now deploy a pod network to the cluster.
</span><span class="z-text z-plain">Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at:
</span><span class="z-text z-plain">  https://kubernetes.io/docs/concepts/cluster-administration/addons/
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Then you can join any number of worker nodes by running the following on each as root:
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">kubeadm join 192.168.0.4:6443 --token abcdef.0123456789abcdef \
</span><span class="z-text z-plain">        --discovery-token-ca-cert-hash sha256:91b1d4502e8950ece37fbc591160007f5e2a3311ff0ebe05112d24851ca082a9
</span></code></pre>
<p>其中下面内容需要自己去执行</p>
<pre class="z-code"><code><span class="z-text z-plain">o start using your cluster, you need to run the following as a regular user:
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">  mkdir -p $HOME/.kube
</span><span class="z-text z-plain">  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
</span><span class="z-text z-plain">  sudo chown $(id -u):$(id -g) $HOME/.kube/config
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Alternatively, if you are the root user, you can run:
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">  export KUBECONFIG=/etc/kubernetes/admin.conf
</span><span class="z-text z-plain">
</span></code></pre>
<p>之后这段内容是加入集群的命令,work节点可以通过下面命令来加入集群</p>
<pre class="z-code"><code><span class="z-text z-plain">Then you can join any number of worker nodes by running the following on each as root:
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">kubeadm join 192.168.0.4:6443 --token abcdef.0123456789abcdef \
</span><span class="z-text z-plain">        --discovery-token-ca-cert-hash sha256:91b1d4502e8950ece37fbc591160007f5e2a3311ff0ebe05112d24851ca082a9
</span><span class="z-text z-plain">
</span></code></pre>
<h2 id="workjie-dian">WORK节点</h2>
<p>WORK节点执行master节点返回的加入集群命令加入集群,出现下面内容即加入成功</p>
<pre class="z-code"><code><span class="z-text z-plain">kubeadm join 192.168.0.4:6443 --token abcdef.0123456789abcdef \
</span><span class="z-text z-plain">        --discovery-token-ca-cert-hash sha256:91b1d4502e8950ece37fbc591160007f5e2a3311ff0ebe05112d24851ca082a9
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">This node has joined the cluster:
</span><span class="z-text z-plain">* Certificate signing request was sent to apiserver and a response was received.
</span><span class="z-text z-plain">* The Kubelet was informed of the new secure connection details.
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">Run &#39;kubectl get nodes&#39; on the control-plane to see this node join the cluster.
</span><span class="z-text z-plain">
</span></code></pre>
<h2 id="wang-luo-cha-jian-calico">网络插件Calico</h2>
<p>选择网络插件可参考<a href="https://kubernetes.io/zh-cn/docs/concepts/cluster-administration/networking/#how-to-implement-the-kubernetes-networking-model">官方文档</a>进行选择本文选用Calico网络插件
在master节点下载calico的yaml文件
curl https://projectcalico.docs.tigera.io/archive/v3.22/manifests/calico.yaml -O
找到下面两行内容进行取消注释并修改value值</p>
<pre class="z-code"><code><span class="z-text z-plain"># - name: CALICO_IPV4POOL_CIDR
</span><span class="z-text z-plain">#   value: &quot;192.168.0.0/16&quot;
</span></code></pre>
<p>value值应为开始创建master节点时的pod网络<code>10.244.0.0/16</code>,修改后为</p>
<pre class="z-code"><code><span class="z-text z-plain">- name: CALICO_IPV4POOL_CIDR
</span><span class="z-text z-plain">  value: &quot;10.244.0.0/16&quot;
</span></code></pre>
<p>之后进行创建，创建方法如下</p>
<pre class="z-code"><code><span class="z-text z-plain">$ sudu kubectl apply -f calico.yaml
</span><span class="z-text z-plain">configmap/calico-config unchanged
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/bgpconfigurations.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/bgppeers.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/blockaffinities.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/caliconodestatuses.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/clusterinformations.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/felixconfigurations.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/globalnetworkpolicies.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/globalnetworksets.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/hostendpoints.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/ipamblocks.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/ipamconfigs.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/ipamhandles.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/ippools.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/ipreservations.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/kubecontrollersconfigurations.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/networkpolicies.crd.projectcalico.org configured
</span><span class="z-text z-plain">customresourcedefinition.apiextensions.k8s.io/networksets.crd.projectcalico.org configured
</span><span class="z-text z-plain">clusterrole.rbac.authorization.k8s.io/calico-kube-controllers unchanged
</span><span class="z-text z-plain">clusterrolebinding.rbac.authorization.k8s.io/calico-kube-controllers unchanged
</span><span class="z-text z-plain">clusterrole.rbac.authorization.k8s.io/calico-node unchanged
</span><span class="z-text z-plain">clusterrolebinding.rbac.authorization.k8s.io/calico-node unchanged
</span><span class="z-text z-plain">daemonset.apps/calico-node created
</span><span class="z-text z-plain">serviceaccount/calico-node created
</span><span class="z-text z-plain">deployment.apps/calico-kube-controllers created
</span><span class="z-text z-plain">serviceaccount/calico-kube-controllers created
</span><span class="z-text z-plain">Warning: policy/v1beta1 PodDisruptionBudget is deprecated in v1.21+, unavailable in v1.25+; use policy/v1 PodDisruptionBudget
</span><span class="z-text z-plain">poddisruptionbudget.policy/calico-kube-controllers created
</span></code></pre>
<p>执行完成没有报错之后可以运行<code>kubectl get node</code>来查看节点的联通状态,当<code>STATUS</code>全都变成Ready即部署成功</p>
<pre class="z-code"><code><span class="z-text z-plain">$ kubectl get node
</span><span class="z-text z-plain">NAME             STATUS   ROLES           AGE   VERSION
</span><span class="z-text z-plain">master.host.com  Ready    control-plane   43m   v1.24.3
</span><span class="z-text z-plain">work1.host.com   Ready    &lt;none&gt;          39m   v1.24.3
</span><span class="z-text z-plain">work2.host.com   Ready    &lt;none&gt;          39m   v1.24.3
</span></code></pre>
<h1 id="wen-ti">问题</h1>
<blockquote>
<p>出现报错以及问题欢迎在评论区讨论</p>
</blockquote>

        </section>
        
        

        
            
            
            

            
        
            
            
            

            
        
            
            
            

            
        
            
            
            

            
        
        </article>
</main>


<span id="copy-success" class="hidden">
        Copied!
    </span>
    <span id="copy-init" class="hidden">
        Copy code to clipboard
    </span>
    <script defer src="https://synex.space/js/copyCodeToClipboard.min.js"></script>


    </div>
    <footer>
    <section>
        <nav class="socials nav-navs">
        </nav>

        
        <nav class="nav-navs">
        </nav>

        <div class="credits">
            <small>
                

                
                Powered by
                <a rel="" 

 href="https://www.getzola.org">Zola</a>
                &amp;
                <a rel="" 

 href="https://github.com/welpo/tabi">tabi</a>

                </small>
        </div>
    </section>

    <div id="searchModal" class="search-modal js" role="dialog" aria-labelledby="modalTitle">
    <h1 id="modalTitle" class="visually-hidden">Search</h1>
    <div id="modal-content">
        <div id="searchBar">
            <div class="search-icon" aria-hidden="true">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                    <path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/>
                </svg>
            </div>
            <input id="searchInput" role="combobox" autocomplete="off" spellcheck="false" aria-expanded="false" aria-controls="results-container" placeholder="Search…"/>
            <div id="clear-search" class="close-icon interactive-icon" tabindex="0" role="button" title="Clear search">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                <path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/>
                </svg>
            </div>
        </div>
        <div id="results-container">
            <div id="results-info"><span id="zero_results"> No results</span>
                <span id="one_results"> $NUMBER result</span>
                <span id="many_results"> $NUMBER results</span><span id="two_results"> $NUMBER results</span>
                <span id="few_results"> $NUMBER results</span>
            </div>
            <div id="results" role="listbox"></div>
        </div>
    </div>
</div>
</footer>


    
    
</body>

</html>
