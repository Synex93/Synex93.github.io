<!DOCTYPE html>
<html lang="en" >

<head>
    <meta charset="UTF-8"><meta http-equiv="Content-Security-Policy"
content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com;connect-src 'self';script-src 'self' 'self'">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="base" content="https://synex.space/">

    
    <title>
~/Syn3x • KVM-虚拟机管理</title>

    
    
    

    
    

    
    
    
        
            <link rel="stylesheet" href="https://synex.space/custom_subset.css?h=0b9535a28bc3d5bf2321">
        
    

    
        <link rel="stylesheet" href="https://synex.space/main.css?h=045c365e19a4d50a64bb" />
        <link rel="stylesheet" href="https://synex.space/skins/mint.css?h=504215cf6bc10586b487" />

    <meta name="color-scheme" content="light dark" />
        <meta name="description" content="" />
        <meta property="og:description" content="" />

    

    <meta property="og:title" content="KVM-虚拟机管理" />
    <meta property="og:type" content="article" />

    
<meta property="og:locale" content="en_GB" />

    <meta property="og:url" content="https:&#x2F;&#x2F;synex.space&#x2F;blog&#x2F;kvm-xu-ni-ji-guan-li&#x2F;" /><meta property="og:site_name" content="~&#x2F;Syn3x">
        <noscript><link rel="stylesheet" href="https://synex.space/no_js.css"/></noscript>
        <script type="text/javascript" src="https://synex.space/js/initializeTheme.min.js"></script>
        <script defer src="https://synex.space/js/themeSwitcher.min.js"></script>
        <script defer src="https://synex.space/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e"></script>

        
    
</head>


<body>
    <a href="#main-content" id="skip-link">Skip to content</a>
    <header>
    <nav class="navbar">
        <div class="nav-title">
            <a class="home-title" href="https://synex.space/">~&#x2F;Syn3x</a>
        </div>
            <div class="nav-navs">
                <ul>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="https://synex.space/blog/">blog
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="https://synex.space/archive/">archive
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="https://synex.space/tags/">tags
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="https://synex.space/friends/">friends
                                </a>
                            </li>
                        <li class="menu-icons-container">
                        <ul class="menu-icons-group">
                            <li class="js menu-icon">
                                <div role="button" tabindex="0" id="search-button" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" aria-label="Click or press $SHORTCUT to open search">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                                        <path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/>
                                    </svg>
                                </div>
                            </li>

                            
                            

                            <li class="theme-switcher-wrapper js"><div
        title="Toggle dark&#x2F;light mode"
        class="theme-switcher"
        tabindex="0"
        role="button"
        aria-label="Toggle dark mode"
        aria-pressed="false">
    </div><div
        title="Reset mode to default"
        class="theme-resetter arrow"
        tabindex="0"
        role="button"
        aria-hidden="true"
        aria-label="Reset mode to default">
    </div>

</li>
</ul>
                    </li>
                </ul>
            </div>
        
    </nav>
</header>

    <div class="content" id="main-content">

        
        





<main>
    <article class="h-entry">
        <h1 class="p-name article-title">
            KVM-虚拟机管理
        </h1>
        <a class="u-url u-uid" href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/"></a>

        <ul class="meta"><span class="hidden p-author h-card">
<a rel="author" href="https:&#x2F;&#x2F;synex.space&#x2F;" class="u-url " title=""></a>
</span>
<li><time class="dt-published" datetime="2024-12-27T18:23:00">27th Dec 2024</time></li><li title="1577 words"><span class='separator' aria-hidden='true'>•</span>8 min read</li><li class="tag"><span class='separator' aria-hidden='true'>•</span>Tags:&nbsp;</li><li class="tag"><a class="p-category" href="https://synex.space/tags/kai-yuan-gong-ju/">开源工具</a>,&nbsp;</li><li class="tag"><a class="p-category" href="https://synex.space/tags/kvm/">kvm</a>,&nbsp;</li><li class="tag"><a class="p-category" href="https://synex.space/tags/qemu/">qemu</a></li>
        </ul><section class="e-content body"><h1 id="guan-yu-xu-ni-hua-ji-shu">关于虚拟化技术</h1>
<p>虚拟化是一种通过模拟计算机硬件，使一台计算机可以同时运行多个不同操作系统的技术。虚拟化极大地提高了硬件资源的利用率，同时降低了物理设备的成本和管理复杂性。</p>
<h1 id="xu-ni-hua-ruan-jian-de-chai-bie">虚拟化软件的差别</h1>
<p>qume 全虚拟化软件，特别慢但是兼容性特别好。
xen     半虚拟化软件，需要使用专门修改之后的内核，性能很高，兼容性很差。redhat在5.5的版本将xen替换成kvm
kvm    全虚拟化软件，它具有硬件支持cpu，内置在linux内核模块中，不需要使用专门的内核。性能好，兼容性好。
kvm的兼容性没有qume好，但是他比qume的性能好太多了
kvm的性能没有xen好，但是他比xen的兼容性好太多了</p>
<h1 id="an-zhuang-kvm">安装KVM</h1>
<p>KVM全称：Kernel-based Virtual Machine
libvirt：因为KVM是基于内核的，linux用户是没办法直接操作内核的，这个软件包就是一个操作的工具。
virt-install：安装虚拟机用的。
qume-kvm：kvm是没有自己的虚拟磁盘技术的，所以直接兼容了qume的虚拟磁盘，这个包即兼容并优化了qume的磁盘。</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">yum</span></span><span class="z-meta z-function-call z-arguments z-shell"> install libvirt virt-install qemu-kvm<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>y</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">systemctl</span></span><span class="z-meta z-function-call z-arguments z-shell"> enable<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>now</span> libvirtd</span>
</span></code></pre>
<h1 id="xu-ji-guan-li">虚机管理</h1>
<h2 id="chuang-jian-yi-ge-xu-ni-ji">创建一个虚拟机</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[root@template</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-meta z-group z-expansion z-tilde"><span class="z-variable z-language z-tilde z-shell">~</span></span>]# virt-install<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>virt-type</span> kvm<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>os-type</span><span class="z-keyword z-operator z-assignment z-option z-shell">=</span>linux<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>os-variant</span> rhel7<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>name</span> centos7<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>memory</span> 1024<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>vcpus</span> 1<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>disk</span> /opt/centos.raw,format=raw,size=10<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>cdrom</span> /opt/CentOS-7-x86_64-Minimal-1511.iso<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>network</span> network=default<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>graphics</span> vnc,listen=0.0.0.0<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>noautoconsole</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Starting</span></span><span class="z-meta z-function-call z-arguments z-shell"> install...</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Allocating</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&#39;</span>centos.raw<span class="z-punctuation z-definition z-string z-end z-shell">&#39;</span></span></span>                   <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span>  <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">10</span></span><span class="z-meta z-function-call z-arguments z-shell"> GB  00:00:00</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Domain</span></span><span class="z-meta z-function-call z-arguments z-shell"> installation still in progress. You can reconnect to</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">the</span></span><span class="z-meta z-function-call z-arguments z-shell"> console to complete the installation process.</span>
</span></code></pre>
<p>要注意的是--cdrom参数，镜像不要放在root目录下会报权限相关的问题，建议丢到一个公共的位置，例如/opt下，然后操控的用户和用户组都是qemu
创建好之后可以通过vnc来连接，这里设置离连接方式是vnc，并且监听的位置是0.0.0.0
<img src="https://image.boychai.xyz/article/Pasted%20image%2020241226152259.png" alt="VNC" /></p>
<h2 id="guan-li-ming-ling">管理命令</h2>
<p>主要使用<code>virsh</code>来管理KVM虚拟机</p>
<h2 id="lie-chu-xu-ji">列出虚机</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> list</span>
</span></code></pre>
<p>这条命令默认是列出所有运行的虚机，如果虚机在关闭状态则不会列出，想要列出所有状态的虚机需要添加<code>--all</code>参数</p>
<h2 id="guan-ji">关机</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> shutdown 虚机名</span>
</span></code></pre>
<p>关机的话系统必须装好，否则没用</p>
<h2 id="kai-ji">开机</h2>
<pre class="z-code"><code><span class="z-text z-plain">virsh start 虚机名
</span></code></pre>
<h2 id="qiang-zhi-guan-ji">强制关机</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> destroy 虚机名</span>
</span></code></pre>
<p>这相当于拔掉虚机的电源</p>
<h2 id="zhong-qi">重启</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> reboot 虚机名</span>
</span></code></pre>
<p>重启的话系统必须装好，否则没用</p>
<h2 id="dao-chu-pei-zhi">导出配置</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> dumpxml 虚机名</span>
</span></code></pre>
<p>导出对应虚机的配置文件</p>
<h2 id="qu-xiao-ding-yi">取消定义</h2>
<p>这里是把对应的虚拟机移除kvm的管理里，相当于从kvm中删除，配置文件也会被删除，但是实际的镜像文件还是会保留。</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> undefine 虚机名</span>
</span></code></pre>
<h2 id="dao-ru-pei-zhi">导入配置</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> define xml配置文件</span>
</span></code></pre>
<h2 id="xiu-gai-pei-zhi">修改配置</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> edit 虚机名</span>
</span></code></pre>
<h2 id="gua-qi">挂起</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> suspend 虚机名</span>
</span></code></pre>
<p>锁定当前状态</p>
<h2 id="hui-fu">恢复</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> resume 虚机名</span>
</span></code></pre>
<h2 id="kai-ji-zi-qi">开机自启</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> autostart 虚机名</span>
</span></code></pre>
<p>可以添加参数<code>--disable</code>来取消开机自启</p>
<h2 id="lie-chu-suo-you-kai-ji-zi-qi-zhu-ji">列出所有开机自启主机</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> list<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>autostart</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>all</span></span>
</span></code></pre>
<p>不加参数<code>--all</code>参数的话，只会列出开机的主机。</p>
<h2 id="kong-zhi-tai">控制台</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> console 虚机名</span>
</span></code></pre>
<p>想要通过<code>console</code>直接连接控制虚机，需要提前在虚拟机中执行下面命令让其支持(执行完请重启虚机)</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">grubby</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>update-kernel</span><span class="z-keyword z-operator z-assignment z-option z-shell">=</span>ALL<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>args</span><span class="z-keyword z-operator z-assignment z-option z-shell">=</span><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>console=ttyS0,115200n8<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span></span>
</span></code></pre>
<h1 id="ci-pan-guan-li">磁盘管理</h1>
<h2 id="guan-yu-ci-pan-ge-shi">关于磁盘格式</h2>
<ul>
<li>RAW：原始格式，也叫野格式，不支持快照功能，不方便传输，读写性能较好。</li>
<li>qcow2：qcow2(copy on write)写时复制(动态占用空间)，占用空间小，支持快照，性能比raw差一点，方便传输。</li>
</ul>
<h2 id="guan-li-ming-ling-1">管理命令</h2>
<p>主要使用<code>qemu-img</code>来管理KVM虚拟机</p>
<h2 id="ci-pan-xin-xi">磁盘信息</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">qemu-img</span></span><span class="z-meta z-function-call z-arguments z-shell"> info 虚拟磁盘</span>
</span></code></pre>
<h2 id="chuang-jian-ci-pan">创建磁盘</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">qemu-img</span></span><span class="z-meta z-function-call z-arguments z-shell"> create<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>f</span> qcow2 位置 大小</span>
</span></code></pre>
<p>例如</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">qemu-img</span></span><span class="z-meta z-function-call z-arguments z-shell"> create<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>f</span> qcow2 /opt/test.qcow2 1G</span>
</span></code></pre>
<p>在<code>/opt/test.qcow2</code>位置创建一个1G大小的磁盘</p>
<h2 id="diao-zheng-rong-liang">调整容量</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">qemu-img</span></span><span class="z-meta z-function-call z-arguments z-shell"> resize /opt/test.qcow2 +1G</span>
</span></code></pre>
<p>给test.qcow2添加1G
后面是容量指令，具体格式参考如下</p>
<ul>
<li>5G    大小调整到5G</li>
<li>+1G 大小增加1G</li>
<li>-1G 大小减小1G</li>
</ul>
<h2 id="rawzhuan-huan-qcow2">RAW转换QCOW2</h2>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">qemu-img</span></span><span class="z-meta z-function-call z-arguments z-shell"> convert<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>f</span> raw<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>O</span> qcow2 xxx.raw xxx.qcow2</span>
</span></code></pre>
<p>这个操作请在虚拟机关闭的状态下执行，执行之后会保留之前的文件然后生成新的qcow2文件。
然后转换之后如果想开机时使用QCOW2的镜像需要edit一下虚机的配置文件</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">qemu-img</span></span><span class="z-meta z-function-call z-arguments z-shell"> convert<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>f</span> raw<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>O</span> qcow2 centos.raw centos.qcow2</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> edit centos7</span>
</span></code></pre>
<p>大概在35行左右,原文如下</p>
<pre data-lang="xml" class="language-xml z-code"><code class="language-xml" data-lang="xml"><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">disk</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">type</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>file<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">device</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>disk<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">driver</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">name</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>qemu<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">type</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>raw<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">driver</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">source</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">file</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>/opt/centos.raw<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">source</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">target</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">dev</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>vda<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">bus</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>virtio<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">target</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">address</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">type</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>pci<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">domain</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x0000<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">bus</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x00<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">slot</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x06<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">function</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x0<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">address</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">disk</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span></code></pre>
<p>修改成下面这种效果</p>
<pre data-lang="xml" class="language-xml z-code"><code class="language-xml" data-lang="xml"><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">disk</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">type</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>file<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">device</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>disk<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">driver</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">name</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>qemu<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">type</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>qcow2<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">driver</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">source</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">file</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>/opt/centos.qcow2<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">source</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">target</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">dev</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>vda<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">bus</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>virtio<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">target</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">address</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">type</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>pci<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">domain</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x0000<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">bus</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x00<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">slot</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x06<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">function</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x0<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">address</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">disk</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span></code></pre>
<h1 id="qi-ta-gong-neng">其他功能</h1>
<h2 id="kuai-zhao">快照</h2>
<h3 id="chuang-jian-kuai-zhao">创建快照</h3>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> snapshot-create centos7<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>atomic</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>disk-only</span></span>
</span></code></pre>
<p>这里我们为虚拟机 centos7 创建了一个快照,使用了 <code>--atomic</code>表示如果失败则完全回滚,<code>--disk-only</code> 表示仅对磁盘创建快照。</p>
<h3 id="cha-kan-kuai-zhao">查看快照</h3>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> snapshot-list centos7</span>
</span></code></pre>
<h3 id="hui-fu-kuai-zhao">恢复快照</h3>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> snapshot-revert centos7 snapshot1</span>
</span></code></pre>
<h3 id="shan-chu-kuai-zhao">删除快照</h3>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> snapshot-delete centos7 snapshot1</span>
</span></code></pre>
<h3 id="qi-ta">其他</h3>
<p>在创建和管理快照时,可以添加选项控制快照类型(disk-only、system-checkpoint等)、是否包含内存状态等,灵活控制快照行为。</p>
<h2 id="ke-long">克隆</h2>
<h3 id="wan-zheng-ke-long">完整克隆</h3>
<p>被克隆的主机一定要处于被挂起或者关闭的状态下
使用virt-clone工具</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[root@template</span></span><span class="z-meta z-function-call z-arguments z-shell"> opt]# virt-clone<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>auto-clone</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>o</span> centos7<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>n</span> centos7-2</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Allocating</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&#39;</span>centos-clone.qcow2<span class="z-punctuation z-definition z-string z-end z-shell">&#39;</span></span></span>                      <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span>  <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">10</span></span><span class="z-meta z-function-call z-arguments z-shell"> GB  00:00:09     </span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Clone</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&#39;</span>centos7-2<span class="z-punctuation z-definition z-string z-end z-shell">&#39;</span></span> created successfully.</span>
</span></code></pre>
<p>手动克隆</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">qemu-img</span></span><span class="z-meta z-function-call z-arguments z-shell"> convert<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>f</span> qcow2<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>O</span> qcow2<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>c</span> centos.qcow2 centos2.qcow2</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> dumpxml centos7 <span class="z-keyword z-operator z-assignment z-redirection z-shell">&gt;</span> centos7-2.xml</span>
</span></code></pre>
<p>编辑导出的xml,主要修改下面几个字段</p>
<pre data-lang="text" class="language-text z-code"><code class="language-text" data-lang="text"><span class="z-text z-plain">修改 domain.name # 名字
</span><span class="z-text z-plain">删除 domain.uuid # uuid
</span><span class="z-text z-plain">删除 domain.devices.interface.mac # mac地址
</span><span class="z-text z-plain">修改 domain.devices.disk.source-file # 虚拟磁盘文件指定为新手动复制的。
</span></code></pre>
<p>编辑好之后导入虚机</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> define centos7-2.xml</span>
</span></code></pre>
<h3 id="lian-jie-ke-long">链接克隆</h3>
<p>连接克隆要注意的是不能使用RAW格式的磁盘，他是不支持的。
创建引用磁盘</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">qemu-img</span></span><span class="z-meta z-function-call z-arguments z-shell"> create<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>f</span> qcow2<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>b</span> centos.qcow2 centos3.qcow2</span>
</span></code></pre>
<p>此时去查看centos3.qcow2的信息如下</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[root@template</span></span><span class="z-meta z-function-call z-arguments z-shell"> opt]# qemu-img info centos3.qcow2              </span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">image:</span></span><span class="z-meta z-function-call z-arguments z-shell"> centos3.qcow2                                          file format: qcow2                                            virtual size: 10G (10737418240 bytes</span><span class="z-meta z-function-call z-shell"></span>)                         <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">disk</span></span><span class="z-meta z-function-call z-arguments z-shell"> size: 196K                                               cluster_size: 65536                                           backing file: centos.qcow2                                    </span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Format</span></span><span class="z-meta z-function-call z-arguments z-shell"> specific information:                                      compat: 1.1                                                   lazy refcounts: false</span>
</span></code></pre>
<p>会发现这个字段<code>backing file: centos.qcow2</code>
导出xml</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> dumpxml centos7 <span class="z-keyword z-operator z-assignment z-redirection z-shell">&gt;</span> centos7-3.xml</span>
</span></code></pre>
<p>编辑导出的xml,主要修改下面几个字段</p>
<pre data-lang="text" class="language-text z-code"><code class="language-text" data-lang="text"><span class="z-text z-plain">修改 domain.name # 名字
</span><span class="z-text z-plain">删除 domain.uuid # uuid
</span><span class="z-text z-plain">删除 domain.devices.interface.mac # mac地址
</span><span class="z-text z-plain">修改 domain.devices.disk.source-file # 虚拟磁盘文件指定为新手动复制的。
</span></code></pre>
<p>编辑好之后导入虚机</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> define centos7-3.xml</span>
</span></code></pre>
<h2 id="wang-luo">网络</h2>
<h3 id="qiao-jie-wang-qia">桥接网卡</h3>
<p>如果想要将主机桥接到某个网络中则需要搞一个桥接网卡，可以通过下面命令进行桥接</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> iface-bridge ens33 br0</span>
</span></code></pre>
<p>ens33是被桥接的网卡，br0是桥接之后的网卡，桥接的过程中可能会出现很多问题，我出现的问题是断网，然后开启网卡开启失败具体可以参考<a href="https://blog.csdn.net/m0_57949020/article/details/119984635">文章</a></p>
<h3 id="qu-xiao-qiao-jie">取消桥接</h3>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> iface-unbridge br0</span>
</span></code></pre>
<h3 id="chuang-jian-xu-ji-zhi-ding-wang-qia">创建虚机指定网卡</h3>
<p>参数<code>--network network=default</code>是NAT模式，全部参数可以参考下面</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virt-install</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>virt-type</span> kvm<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>os-type</span><span class="z-keyword z-operator z-assignment z-option z-shell">=</span>linux<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>os-variant</span> rhel7<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>name</span> centos7<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>memory</span> 1024<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>vcpus</span> 1<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>disk</span> /opt/centos.raw,format=raw,size=10<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>cdrom</span> /opt/CentOS-7-x86_64-Minimal-1511.iso<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>network</span> network=default<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>graphics</span> vnc,listen=0.0.0.0<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>noautoconsole</span></span>
</span></code></pre>
<p>参数<code>--network bridge=br0</code>是桥接模式，全部参数可以参考下面</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virt-install</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>virt-type</span> kvm<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>os-type</span><span class="z-keyword z-operator z-assignment z-option z-shell">=</span>linux<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>os-variant</span> rhel7<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>name</span> centos7<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>memory</span> 1024<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>vcpus</span> 1<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>disk</span> /opt/centos.raw,format=raw,size=10<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>cdrom</span> /opt/CentOS-7-x86_64-Minimal-1511.iso<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>network</span> bridge=br0<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>graphics</span> vnc,listen=0.0.0.0<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>noautoconsole</span></span>
</span></code></pre>
<h3 id="yi-you-xu-ji-geng-huan-wang-qia">已有虚机更换网卡</h3>
<p>通过下面命令编辑配置</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">virsh</span></span><span class="z-meta z-function-call z-arguments z-shell"> edit 虚机名</span>
</span></code></pre>
<p>修改<code>domain.devices.interface</code>字段，默认值如下</p>
<pre data-lang="xml" class="language-xml z-code"><code class="language-xml" data-lang="xml"><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">interface</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">type</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>network<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">mac</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">address</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>52:54:00:25:a6:67<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">mac</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">source</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">network</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>default<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">source</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">model</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">type</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>virtio<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">model</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">address</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">type</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>pci<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">domain</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x0000<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">bus</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x00<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">slot</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x03<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">function</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x0<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">address</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">interface</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span></code></pre>
<p>修改成下面这样</p>
<pre data-lang="xml" class="language-xml z-code"><code class="language-xml" data-lang="xml"><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">interface</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">type</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>bridge<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">mac</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">address</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>52:54:00:25:a6:67<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">mac</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">source</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">bridge</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>br0<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">source</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">model</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">type</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>virtio<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">model</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">      <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;</span><span class="z-entity z-name z-tag z-localname z-xml">address</span> <span class="z-entity z-other z-attribute-name z-localname z-xml">type</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>pci<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">domain</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x0000<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">bus</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x00<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">slot</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x03<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span> <span class="z-entity z-other z-attribute-name z-localname z-xml">function</span><span class="z-punctuation z-separator z-key-value z-xml">=</span><span class="z-string z-quoted z-single z-xml"><span class="z-punctuation z-definition z-string z-begin z-xml">&#39;</span>0x0<span class="z-punctuation z-definition z-string z-end z-xml">&#39;</span></span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span><span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">address</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span><span class="z-text z-xml">    <span class="z-meta z-tag z-xml"><span class="z-punctuation z-definition z-tag z-begin z-xml">&lt;/</span><span class="z-entity z-name z-tag z-localname z-xml">interface</span><span class="z-punctuation z-definition z-tag z-end z-xml">&gt;</span></span>
</span></code></pre>
<p>主要是<code>interface</code>的<code>type</code>字段和<code>interface.source</code>的字段。</p>
<h3 id="zhu-yi">注意</h3>
<p>每次桥接和取消桥接都会永久性的修改网卡的配置文件，这个需要注意。</p>
<h1 id="guan-yu-kvmchuang-jian-de-xu-ni-ji">关于KVM创建的虚拟机</h1>
<p>KVM虚拟机主要有两部分组成，一部分是磁盘文件，在创建的时候通过下面命令已经指定
<code>--disk /opt/centos.raw,format=raw,size=10</code>
另外一部分是配置文件，配置文件默认位置在<code>/etc/libvirt/qemu</code>中，一般采用dumpxml来导出，只要拥有xml和镜像文件就可以恢复虚机。</p>

        </section>
        
        

        
            
            
            

            
        
            
            
            

            
        
            
            
            

            
        
            
            
            

            
        
        </article>
</main>

    <div id="button-container">
        
        
            <div id="toc-floating-container">
                <input type="checkbox" id="toc-toggle" class="toggle"/>
                <label for="toc-toggle" id="toc-button" class="button" title="Toggle Table of Contents">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960"><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg>
                </label>
                <div class="toc-content">
                    

<div class="toc-container">
    

    <ul>
        
            
            
                <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#guan-yu-xu-ni-hua-ji-shu">关于虚拟化技术</a>
                    
                </li>
            
        
            
            
                <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#xu-ni-hua-ruan-jian-de-chai-bie">虚拟化软件的差别</a>
                    
                </li>
            
        
            
            
                <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#an-zhuang-kvm">安装KVM</a>
                    
                </li>
            
        
            
            
                <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#xu-ji-guan-li">虚机管理</a>
                    
                        <ul>
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#chuang-jian-yi-ge-xu-ni-ji">创建一个虚拟机</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#guan-li-ming-ling">管理命令</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#lie-chu-xu-ji">列出虚机</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#guan-ji">关机</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#kai-ji">开机</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#qiang-zhi-guan-ji">强制关机</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#zhong-qi">重启</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#dao-chu-pei-zhi">导出配置</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#qu-xiao-ding-yi">取消定义</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#dao-ru-pei-zhi">导入配置</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#xiu-gai-pei-zhi">修改配置</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#gua-qi">挂起</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#hui-fu">恢复</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#kai-ji-zi-qi">开机自启</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#lie-chu-suo-you-kai-ji-zi-qi-zhu-ji">列出所有开机自启主机</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#kong-zhi-tai">控制台</a>
                                        
                                    </li>
                                
                            
                        </ul>
                    
                </li>
            
        
            
            
                <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#ci-pan-guan-li">磁盘管理</a>
                    
                        <ul>
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#guan-yu-ci-pan-ge-shi">关于磁盘格式</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#guan-li-ming-ling-1">管理命令</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#ci-pan-xin-xi">磁盘信息</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#chuang-jian-ci-pan">创建磁盘</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#diao-zheng-rong-liang">调整容量</a>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#rawzhuan-huan-qcow2">RAW转换QCOW2</a>
                                        
                                    </li>
                                
                            
                        </ul>
                    
                </li>
            
        
            
            
                <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#qi-ta-gong-neng">其他功能</a>
                    
                        <ul>
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#kuai-zhao">快照</a>
                                        
                                            <ul>
                                                
                                                    
                                                        <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#chuang-jian-kuai-zhao">创建快照</a>
                                                            
                                                        </li>
                                                    
                                                
                                                    
                                                        <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#cha-kan-kuai-zhao">查看快照</a>
                                                            
                                                        </li>
                                                    
                                                
                                                    
                                                        <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#hui-fu-kuai-zhao">恢复快照</a>
                                                            
                                                        </li>
                                                    
                                                
                                                    
                                                        <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#shan-chu-kuai-zhao">删除快照</a>
                                                            
                                                        </li>
                                                    
                                                
                                                    
                                                        <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#qi-ta">其他</a>
                                                            
                                                        </li>
                                                    
                                                
                                            </ul>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#ke-long">克隆</a>
                                        
                                            <ul>
                                                
                                                    
                                                        <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#wan-zheng-ke-long">完整克隆</a>
                                                            
                                                        </li>
                                                    
                                                
                                                    
                                                        <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#lian-jie-ke-long">链接克隆</a>
                                                            
                                                        </li>
                                                    
                                                
                                            </ul>
                                        
                                    </li>
                                
                            
                                
                                    <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#wang-luo">网络</a>
                                        
                                            <ul>
                                                
                                                    
                                                        <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#qiao-jie-wang-qia">桥接网卡</a>
                                                            
                                                        </li>
                                                    
                                                
                                                    
                                                        <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#qu-xiao-qiao-jie">取消桥接</a>
                                                            
                                                        </li>
                                                    
                                                
                                                    
                                                        <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#chuang-jian-xu-ji-zhi-ding-wang-qia">创建虚机指定网卡</a>
                                                            
                                                        </li>
                                                    
                                                
                                                    
                                                        <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#yi-you-xu-ji-geng-huan-wang-qia">已有虚机更换网卡</a>
                                                            
                                                        </li>
                                                    
                                                
                                                    
                                                        <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#zhu-yi">注意</a>
                                                            
                                                        </li>
                                                    
                                                
                                            </ul>
                                        
                                    </li>
                                
                            
                        </ul>
                    
                </li>
            
        
            
            
                <li><a href="https://synex.space/blog/kvm-xu-ni-ji-guan-li/#guan-yu-kvmchuang-jian-de-xu-ni-ji">关于KVM创建的虚拟机</a>
                    
                </li>
            
        
    </ul>
</div>


                </div>
            </div>
        

        
        

        
        <a href="#" id="top-button" class="no-hover-padding" title="Go to the top of the page">
            <svg viewBox="0 0 20 20" fill="currentColor"><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg>
        </a>
    </div>


<span id="copy-success" class="hidden">
        Copied!
    </span>
    <span id="copy-init" class="hidden">
        Copy code to clipboard
    </span>
    <script defer src="https://synex.space/js/copyCodeToClipboard.min.js"></script>


    </div>
    <footer>
    <section>
        <nav class="socials nav-navs">
        </nav>

        
        <nav class="nav-navs">
        </nav>

        <div class="credits">
            <small>
                

                
                Powered by
                <a rel="" 

 href="https://www.getzola.org">Zola</a>
                &amp;
                <a rel="" 

 href="https://github.com/welpo/tabi">tabi</a>

                </small>
        </div>
    </section>

    <div id="searchModal" class="search-modal js" role="dialog" aria-labelledby="modalTitle">
    <h1 id="modalTitle" class="visually-hidden">Search</h1>
    <div id="modal-content">
        <div id="searchBar">
            <div class="search-icon" aria-hidden="true">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                    <path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/>
                </svg>
            </div>
            <input id="searchInput" role="combobox" autocomplete="off" spellcheck="false" aria-expanded="false" aria-controls="results-container" placeholder="Search…"/>
            <div id="clear-search" class="close-icon interactive-icon" tabindex="0" role="button" title="Clear search">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                <path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/>
                </svg>
            </div>
        </div>
        <div id="results-container">
            <div id="results-info"><span id="zero_results"> No results</span>
                <span id="one_results"> $NUMBER result</span>
                <span id="many_results"> $NUMBER results</span><span id="two_results"> $NUMBER results</span>
                <span id="few_results"> $NUMBER results</span>
            </div>
            <div id="results" role="listbox"></div>
        </div>
    </div>
</div>
</footer>


    
    
</body>

</html>
